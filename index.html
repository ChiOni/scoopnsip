<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCOOPNSIP - Wine Journey</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, sans-serif; overflow-x: hidden; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .drawer { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .scale-in { animation: scaleIn 0.2s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .country-marker { cursor: pointer; transition: all 0.2s ease; }
        .country-marker:hover { transform: scale(1.2); filter: brightness(1.2); }
        input[type="range"] { -webkit-appearance: none; height: 4px; background: #E5E7EB; border-radius: 2px; outline: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; background: #8B5CF6; border-radius: 50%; cursor: pointer; }
        input[type="range"]::-moz-range-thumb { width: 16px; height: 16px; background: #8B5CF6; border-radius: 50%; cursor: pointer; border: none; }
        .wine-card { border-bottom: 1px solid #F3F4F6; transition: background-color 0.2s ease; }
        .wine-card:hover { background-color: #F9FAFB; }
        .wine-card:active { background-color: #F3F4F6; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script>
        // Firebase Ï¥àÍ∏∞Ìôî
        const firebaseConfig = {
            apiKey: "AIzaSyAAIYwhWkTbCz8-1HyKTEt8AjfCwqyqqBc",
            authDomain: "scoopnsip-8948d.firebaseapp.com",
            projectId: "scoopnsip-8948d",
            storageBucket: "scoopnsip-8948d.appspot.com",
            messagingSenderId: "815208674310",
            appId: "1:815208674310:web:c33930138a5c2fdcc3bf87"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const COUNTRIES = {
            france: { name: 'ÌîÑÎûëÏä§', x: 49.5, y: 32, color: '#DC2626' },
            italy: { name: 'Ïù¥ÌÉàÎ¶¨ÏïÑ', x: 51, y: 34, color: '#059669' },
            spain: { name: 'Ïä§ÌéòÏù∏', x: 47.5, y: 35, color: '#D97706' },
            usa: { name: 'ÎØ∏Íµ≠', x: 18, y: 36, color: '#2563EB' },
            chile: { name: 'Ïπ†Î†à', x: 24, y: 65, color: '#7C3AED' },
            argentina: { name: 'ÏïÑÎ•¥Ìó®Ìã∞ÎÇò', x: 27, y: 68, color: '#DB2777' },
            australia: { name: 'Ìò∏Ï£º', x: 77, y: 67, color: '#0891B2' },
            newzealand: { name: 'Îâ¥ÏßàÎûúÎìú', x: 84, y: 73, color: '#65A30D' },
            germany: { name: 'ÎèÖÏùº', x: 50, y: 31, color: '#F59E0B' },
            portugal: { name: 'Ìè¨Î•¥Ìà¨Í∞à', x: 46.5, y: 36, color: '#EC4899' },
            southafrica: { name: 'ÎÇ®ÏïÑÍ≥µ', x: 53, y: 69, color: '#8B5CF6' },
            korea: { name: 'ÌïúÍµ≠', x: 74, y: 34, color: '#10B981' },
            japan: { name: 'ÏùºÎ≥∏', x: 77, y: 34, color: '#EF4444' }
        };
        
        const PASSWORD_HASH = '1c8fe0ec46c4d990dc9d51da05b35d284fe86d9f0841777b4cf8a3a3284c16e9';
        
        function WineApp() {
            const [wines, setWines] = useState([]);
            const [selectedCountry, setSelectedCountry] = useState(null);
            const [selectedWine, setSelectedWine] = useState(null);
            const [drawerView, setDrawerView] = useState('list');
            const [passwordInput, setPasswordInput] = useState('');
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [loading, setLoading] = useState(true);
            const [saving, setSaving] = useState(false);
            
            const [newWine, setNewWine] = useState({
                date: new Date().toISOString().split('T')[0],
                name: '', image: null, imagePreview: null, winery: '', wineryInfo: '',
                country: '', sweetness: 3, acidity: 3, body: 3, description: '', reviews: ''
            });

            useEffect(() => {
                // Firebase Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
                console.log('Firebase Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú:', {
                    app: firebase.app().name,
                    firestore: !!db
                });
                loadWines();
            }, []);

            async function loadWines() {
                setLoading(true);
                try {
                    const snapshot = await db.collection('wines').get();
                    const wineData = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    setWines(wineData);
                } catch (error) {
                    console.error('Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ïò§Î•ò:', error);
                }
                setLoading(false);
            }

            async function saveWine(wine) {
                try {
                    console.log('=== Ï†ÄÏû• ÏãúÏûë ===');

                    // Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞ ÌôïÏù∏ (Firestore Î¨∏ÏÑú Ï†úÌïú: 1MB)
                    const imageSize = wine.image ? wine.image.length * 0.75 : 0; // base64 -> bytes
                    console.log('Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞:', Math.round(imageSize / 1024), 'KB');

                    if (imageSize > 900000) { // 900KB Ï†úÌïú (ÏïàÏ†Ñ ÎßàÏßÑ)
                        alert('Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞Í∞Ä ÎÑàÎ¨¥ ÌÅΩÎãàÎã§. Îçî ÏûëÏùÄ Ïù¥ÎØ∏ÏßÄÎ•º ÏÇ¨Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.');
                        throw new Error('Image too large');
                    }

                    // FirestoreÏóê Ï†ÄÏû• (Ïù¥ÎØ∏ÏßÄ base64 Ìè¨Ìï®)
                    console.log('Firestore Ï†ÄÏû• Ï§ë...');
                    const docRef = await db.collection('wines').add(wine);
                    console.log('Firestore Ï†ÄÏû• ÏôÑÎ£å:', docRef.id);
                    console.log('=== Ï†ÄÏû• ÏÑ±Í≥µ ===');
                } catch (error) {
                    console.error('=== Ï†ÄÏû• Ïò§Î•ò ÏÉÅÏÑ∏ ===');
                    console.error('Error name:', error.name);
                    console.error('Error message:', error.message);
                    console.error('Error code:', error.code);
                    console.error('Full error:', error);

                    let errorMessage = 'Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\n\n';
                    if (error.code === 'permission-denied') {
                        errorMessage += '‚ùå Firestore Í∂åÌïú Ïò§Î•ò\n\nFirebase ConsoleÏóêÏÑú Firestore RulesÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
                    } else {
                        errorMessage += 'Ïò§Î•ò: ' + error.message;
                    }

                    alert(errorMessage);
                    throw error;
                }
            }

            async function sha256(message) {
                const msgBuffer = new TextEncoder().encode(message);
                const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                return hashHex;
            }

            function handleCountryClick(countryKey) {
                setSelectedCountry(countryKey);
                setDrawerView('list');
                setIsAuthenticated(false);
                setPasswordInput('');
            }

            function closeDrawer() {
                setSelectedCountry(null);
                setSelectedWine(null);
                setDrawerView('list');
                setPasswordInput('');
            }

            async function handlePasswordSubmit() {
                const inputHash = await sha256(passwordInput);
                if (inputHash === PASSWORD_HASH) {
                    setIsAuthenticated(true);
                    setDrawerView('create');
                    setPasswordInput('');
                    setNewWine({...newWine, country: selectedCountry, date: new Date().toISOString().split('T')[0]});
                } else {
                    alert('ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.');
                    setPasswordInput('');
                }
            }

            function handleImageUpload(e) {
                const file = e.target.files[0];
                if (file) {
                    // Ïù¥ÎØ∏ÏßÄ ÏïïÏ∂ï (ÏµúÎåÄ 800x800, ÌíàÏßà 0.8)
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            let width = img.width;
                            let height = img.height;

                            // ÏµúÎåÄ ÌÅ¨Í∏∞ Ï†úÌïú (800px)
                            const maxSize = 800;
                            if (width > height && width > maxSize) {
                                height = (height * maxSize) / width;
                                width = maxSize;
                            } else if (height > maxSize) {
                                width = (width * maxSize) / height;
                                height = maxSize;
                            }

                            canvas.width = width;
                            canvas.height = height;

                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 0, 0, width, height);

                            // JPEGÎ°ú Î≥ÄÌôò, ÌíàÏßà 0.8
                            const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                            setNewWine({...newWine, image: compressedDataUrl, imagePreview: compressedDataUrl});

                            console.log('Ïù¥ÎØ∏ÏßÄ ÏïïÏ∂ï ÏôÑÎ£å:', {
                                ÏõêÎ≥∏ÌÅ¨Í∏∞: file.size,
                                ÏïïÏ∂ïÌõÑÌÅ¨Í∏∞: Math.round(compressedDataUrl.length * 0.75),
                                Ìï¥ÏÉÅÎèÑ: `${width}x${height}`
                            });
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            }

            async function handleCreateWine() {
                if (!newWine.name || !newWine.image || !newWine.winery) {
                    alert('ÏôÄÏù∏ Ïù¥Î¶Ñ, ÏÇ¨ÏßÑ, ÏôÄÏù¥ÎÑàÎ¶¨ Ïù¥Î¶ÑÏùÄ ÌïÑÏàòÏûÖÎãàÎã§.');
                    return;
                }

                setSaving(true);

                try {
                    const wine = {
                        date: newWine.date,
                        name: newWine.name,
                        image: newWine.image,
                        winery: newWine.winery,
                        wineryInfo: newWine.wineryInfo,
                        country: newWine.country,
                        sweetness: newWine.sweetness,
                        acidity: newWine.acidity,
                        body: newWine.body,
                        description: newWine.description,
                        reviews: newWine.reviews,
                        timestamp: Date.now()
                    };

                    await saveWine(wine);
                    await loadWines();

                    setNewWine({
                        date: new Date().toISOString().split('T')[0],
                        name: '', image: null, imagePreview: null, winery: '', wineryInfo: '',
                        country: '', sweetness: 3, acidity: 3, body: 3, description: '', reviews: ''
                    });
                    setPasswordInput('');
                    setIsAuthenticated(false);
                    setDrawerView('list');

                    alert('ÏôÄÏù∏Ïù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§! üç∑');
                } catch (error) {
                    console.error('Error:', error);
                    // saveWineÏóêÏÑú Ïù¥ÎØ∏ alertÎ•º ÌëúÏãúÌïòÎØÄÎ°ú Ïó¨Í∏∞ÏÑúÎäî Ï∂îÍ∞Ä Ï≤òÎ¶¨ Î∂àÌïÑÏöî
                } finally {
                    setSaving(false);
                }
            }

            const countryWines = wines.filter(w => w.country === selectedCountry).sort((a, b) => b.timestamp - a.timestamp);

            if (loading) {
                return (
                    <div className="w-full h-screen flex items-center justify-center bg-white">
                        <div className="text-center">
                            <div className="text-6xl mb-4">üç∑</div>
                            <p className="text-gray-400 text-sm font-light">Loading...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="relative w-full h-screen overflow-hidden bg-gradient-to-br from-purple-50 via-white to-pink-50">
                    <header className="absolute top-0 left-0 right-0 z-20 bg-white/80 backdrop-blur-md border-b border-gray-100">
                        <div className="max-w-7xl mx-auto px-6 py-4">
                            <h1 className="font-serif text-2xl font-bold text-gray-900">SCOOPNSIP</h1>
                            <p className="text-xs text-gray-500 mt-1">Wine Journey Around The World</p>
                        </div>
                    </header>

                    <div className="w-full h-full pt-16 pb-4 px-4 flex items-center justify-center">
                        <div className="relative w-full h-full max-w-none">
                            {/* ÏÑ∏Í≥Ñ ÏßÄÎèÑ Ïù¥ÎØ∏ÏßÄ */}
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/World_map_-_low_resolution.svg/2560px-World_map_-_low_resolution.svg.png"
                                 alt="World Map"
                                 className="w-full h-full absolute inset-0 object-contain opacity-20"
                                 style={{ filter: 'grayscale(100%)' }} />

                            {Object.entries(COUNTRIES).map(([key, country]) => {
                                const wineCount = wines.filter(w => w.country === key).length;
                                return (
                                    <div key={key} className="country-marker absolute transform -translate-x-1/2 -translate-y-1/2"
                                         style={{ left: `${country.x}%`, top: `${country.y}%` }}
                                         onClick={() => handleCountryClick(key)}>
                                        <div className="relative">
                                            <div className="w-6 h-6 rounded-full shadow-lg flex items-center justify-center"
                                                 style={{ backgroundColor: country.color }}>
                                                {wineCount > 0 && <span className="text-white text-xs font-bold">{wineCount}</span>}
                                            </div>
                                            <div className="absolute top-8 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                                                <span className="text-xs font-medium text-gray-700 bg-white/90 px-2 py-1 rounded shadow">
                                                    {country.name}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {selectedCountry && (
                        <>
                            <div className="fixed inset-0 bg-black/30 z-30 fade-in" onClick={closeDrawer} />
                            
                            <div className="fixed right-0 top-0 bottom-0 w-full max-w-md bg-white shadow-2xl z-40 drawer scale-in overflow-hidden flex flex-col">
                                <div className="flex items-center justify-between px-6 py-4 border-b border-gray-100">
                                    <button onClick={closeDrawer} className="text-gray-600 hover:text-gray-900">
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                    <h2 className="font-serif text-xl font-semibold text-gray-900">{COUNTRIES[selectedCountry].name}</h2>
                                    {drawerView === 'list' && (
                                        <button onClick={() => setDrawerView('password')} className="text-gray-600 hover:text-gray-900 active:scale-95 transition">
                                            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                            </svg>
                                        </button>
                                    )}
                                    {drawerView !== 'list' && <div className="w-6" />}
                                </div>

                                <div className="flex-1 overflow-y-auto">
                                    {drawerView === 'list' && (
                                        <div>
                                            {countryWines.length === 0 ? (
                                                <div className="flex flex-col items-center justify-center py-20 px-6">
                                                    <div className="text-6xl mb-4 opacity-20">üç∑</div>
                                                    <p className="text-gray-400 text-sm">ÏïÑÏßÅ ÏôÄÏù∏Ïù¥ ÏóÜÏäµÎãàÎã§</p>
                                                </div>
                                            ) : (
                                                countryWines.map(wine => (
                                                    <div key={wine.id} className="wine-card cursor-pointer" onClick={() => { setSelectedWine(wine); setDrawerView('detail'); }}>
                                                        <div className="flex items-center p-4 gap-4">
                                                            <img src={wine.image} alt={wine.name} className="w-16 h-16 rounded-lg object-cover" />
                                                            <div className="flex-1 min-w-0">
                                                                <p className="text-xs text-gray-500 mb-1">{wine.date}</p>
                                                                <h3 className="font-medium text-gray-900 truncate">{wine.name}</h3>
                                                                <p className="text-sm text-gray-600 truncate">{wine.winery}</p>
                                                            </div>
                                                            <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                            </svg>
                                                        </div>
                                                    </div>
                                                ))
                                            )}
                                        </div>
                                    )}

                                    {drawerView === 'password' && (
                                        <div className="flex flex-col items-center justify-center py-20 px-6">
                                            <div className="w-full max-w-xs">
                                                <h3 className="text-lg font-semibold text-gray-900 mb-2 text-center">ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•</h3>
                                                <p className="text-sm text-gray-500 mb-6 text-center">Í¥ÄÎ¶¨ÏûêÎßå ÏôÄÏù∏ÏùÑ Ï∂îÍ∞ÄÌï† Ïàò ÏûàÏäµÎãàÎã§</p>
                                                <input type="password" value={passwordInput} onChange={(e) => setPasswordInput(e.target.value)}
                                                       onKeyPress={(e) => e.key === 'Enter' && handlePasswordSubmit()}
                                                       placeholder="6ÏûêÎ¶¨ ÎπÑÎ∞ÄÎ≤àÌò∏" maxLength={6}
                                                       className="w-full px-4 py-3 border border-gray-200 rounded-lg text-center text-lg tracking-widest focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                                <button onClick={handlePasswordSubmit}
                                                        className="w-full mt-4 bg-gray-900 text-white py-3 rounded-lg font-medium hover:bg-gray-800 transition">
                                                    ÌôïÏù∏
                                                </button>
                                                <button onClick={() => setDrawerView('list')}
                                                        className="w-full mt-2 text-gray-600 py-3 rounded-lg font-medium hover:bg-gray-50 transition">
                                                    Ï∑®ÏÜå
                                                </button>
                                            </div>
                                        </div>
                                    )}

                                    {drawerView === 'create' && (
                                        <div className="p-6 space-y-6">
                                            <h3 className="font-serif text-xl font-semibold text-gray-900">ÏÉà ÏôÄÏù∏ Ï∂îÍ∞Ä</h3>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÌåêÎß§ ÏùºÏûê *</label>
                                                <input type="date" value={newWine.date} onChange={(e) => setNewWine({...newWine, date: e.target.value})}
                                                       className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÏôÄÏù∏ ÏÇ¨ÏßÑ *</label>
                                                {newWine.imagePreview ? (
                                                    <div className="relative">
                                                        <img src={newWine.imagePreview} alt="Preview" className="w-full rounded-lg" style={{aspectRatio: '1'}} />
                                                        <button onClick={() => setNewWine({...newWine, image: null, imagePreview: null})}
                                                                className="absolute top-2 right-2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100">
                                                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                                            </svg>
                                                        </button>
                                                    </div>
                                                ) : (
                                                    <label className="block w-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-purple-500 transition" style={{aspectRatio: '1'}}>
                                                        <input type="file" accept="image/*" onChange={handleImageUpload} className="hidden" />
                                                        <div className="flex flex-col items-center justify-center h-full text-gray-400">
                                                            <svg className="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                                            </svg>
                                                            <span className="text-sm">ÏÇ¨ÏßÑ ÏóÖÎ°úÎìú</span>
                                                        </div>
                                                    </label>
                                                )}
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÏôÄÏù∏ Ïù¥Î¶Ñ *</label>
                                                <input type="text" value={newWine.name} onChange={(e) => setNewWine({...newWine, name: e.target.value})}
                                                       placeholder="Ïòà: Ch√¢teau Margaux 2015"
                                                       className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÏôÄÏù¥ÎÑàÎ¶¨ Ïù¥Î¶Ñ *</label>
                                                <input type="text" value={newWine.winery} onChange={(e) => setNewWine({...newWine, winery: e.target.value})}
                                                       placeholder="Ïòà: Ch√¢teau Margaux"
                                                       className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÏôÄÏù¥ÎÑàÎ¶¨ Ï†ïÎ≥¥</label>
                                                <textarea value={newWine.wineryInfo} onChange={(e) => setNewWine({...newWine, wineryInfo: e.target.value})}
                                                          placeholder="ÏôÄÏù¥ÎÑàÎ¶¨Ïùò Ïó≠ÏÇ¨, ÌäπÏßï Îì±" rows={3}
                                                          className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÎãπÎèÑ: {newWine.sweetness}</label>
                                                <input type="range" min="1" max="5" value={newWine.sweetness}
                                                       onChange={(e) => setNewWine({...newWine, sweetness: parseInt(e.target.value)})} className="w-full" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÏÇ∞ÎèÑ: {newWine.acidity}</label>
                                                <input type="range" min="1" max="5" value={newWine.acidity}
                                                       onChange={(e) => setNewWine({...newWine, acidity: parseInt(e.target.value)})} className="w-full" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Î∞îÎîî: {newWine.body}</label>
                                                <input type="range" min="1" max="5" value={newWine.body}
                                                       onChange={(e) => setNewWine({...newWine, body: parseInt(e.target.value)})} className="w-full" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">ÏôÄÏù∏ ÏÑ§Î™Ö</label>
                                                <textarea value={newWine.description} onChange={(e) => setNewWine({...newWine, description: e.target.value})}
                                                          placeholder="ÏôÄÏù∏Ïùò ÌäπÏßï, Ìñ•, Îßõ Îì±" rows={4}
                                                          className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Í≥†Í∞ù ÌõÑÍ∏∞</label>
                                                <textarea value={newWine.reviews} onChange={(e) => setNewWine({...newWine, reviews: e.target.value})}
                                                          placeholder="Í≥†Í∞ùÎì§Ïùò Í∞êÏÉÅ" rows={4}
                                                          className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none" />
                                            </div>

                                            <div className="flex gap-3 pt-4">
                                                <button onClick={() => setDrawerView('list')}
                                                        disabled={saving}
                                                        className="flex-1 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed">
                                                    Ï∑®ÏÜå
                                                </button>
                                                <button onClick={handleCreateWine}
                                                        disabled={saving}
                                                        className="flex-1 py-3 bg-gray-900 text-white rounded-lg font-medium hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
                                                    {saving ? (
                                                        <>
                                                            <svg className="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                                                                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                                                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                                            </svg>
                                                            <span>Ï†ÄÏû• Ï§ë...</span>
                                                        </>
                                                    ) : 'Ï†ÄÏû•'}
                                                </button>
                                            </div>
                                        </div>
                                    )}

                                    {drawerView === 'detail' && selectedWine && (
                                        <div>
                                            <img src={selectedWine.image} alt={selectedWine.name} className="w-full object-cover" style={{aspectRatio: '1'}} />
                                            <div className="p-6 space-y-6">
                                                <div>
                                                    <p className="text-sm text-gray-500 mb-1">{selectedWine.date}</p>
                                                    <h2 className="font-serif text-2xl font-bold text-gray-900 mb-2">{selectedWine.name}</h2>
                                                    <p className="text-lg text-gray-600">{selectedWine.winery}</p>
                                                </div>

                                                {selectedWine.wineryInfo && (
                                                    <div>
                                                        <h3 className="font-semibold text-gray-900 mb-2">ÏôÄÏù¥ÎÑàÎ¶¨</h3>
                                                        <p className="text-gray-600 text-sm leading-relaxed">{selectedWine.wineryInfo}</p>
                                                    </div>
                                                )}

                                                <div>
                                                    <h3 className="font-semibold text-gray-900 mb-3">ÌäπÏÑ±</h3>
                                                    <div className="space-y-3">
                                                        <div>
                                                            <div className="flex justify-between text-sm mb-1">
                                                                <span className="text-gray-600">ÎãπÎèÑ</span>
                                                                <span className="font-medium">{selectedWine.sweetness}/5</span>
                                                            </div>
                                                            <div className="h-2 bg-gray-100 rounded-full overflow-hidden">
                                                                <div className="h-full bg-purple-500 rounded-full"
                                                                     style={{ width: `${(selectedWine.sweetness / 5) * 100}%` }} />
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <div className="flex justify-between text-sm mb-1">
                                                                <span className="text-gray-600">ÏÇ∞ÎèÑ</span>
                                                                <span className="font-medium">{selectedWine.acidity}/5</span>
                                                            </div>
                                                            <div className="h-2 bg-gray-100 rounded-full overflow-hidden">
                                                                <div className="h-full bg-pink-500 rounded-full"
                                                                     style={{ width: `${(selectedWine.acidity / 5) * 100}%` }} />
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <div className="flex justify-between text-sm mb-1">
                                                                <span className="text-gray-600">Î∞îÎîî</span>
                                                                <span className="font-medium">{selectedWine.body}/5</span>
                                                            </div>
                                                            <div className="h-2 bg-gray-100 rounded-full overflow-hidden">
                                                                <div className="h-full bg-red-500 rounded-full"
                                                                     style={{ width: `${(selectedWine.body / 5) * 100}%` }} />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                {selectedWine.description && (
                                                    <div>
                                                        <h3 className="font-semibold text-gray-900 mb-2">ÌÖåÏù¥Ïä§ÌåÖ ÎÖ∏Ìä∏</h3>
                                                        <p className="text-gray-600 text-sm leading-relaxed whitespace-pre-line">{selectedWine.description}</p>
                                                    </div>
                                                )}

                                                {selectedWine.reviews && (
                                                    <div>
                                                        <h3 className="font-semibold text-gray-900 mb-2">Í≥†Í∞ù ÌõÑÍ∏∞</h3>
                                                        <div className="bg-gray-50 rounded-lg p-4">
                                                            <p className="text-gray-600 text-sm leading-relaxed whitespace-pre-line italic">{selectedWine.reviews}</p>
                                                        </div>
                                                    </div>
                                                )}

                                                <button onClick={() => { setDrawerView('list'); setSelectedWine(null); }}
                                                        className="w-full py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition">
                                                    Î™©Î°ùÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </>
                    )}
                </div>
            );
        }

        ReactDOM.render(<WineApp />, document.getElementById('root'));
    </script>
</body>
</html>